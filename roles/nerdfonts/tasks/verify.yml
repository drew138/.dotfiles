---
- name: Verify Fonts directory exists
  ansible.builtin.stat:
    path: "{{ ansible_facts['env']['HOME'] }}/Library/Fonts"
  register: verify_fonts_dir

- name: Assert Fonts directory exists
  ansible.builtin.assert:
    that:
      - verify_fonts_dir.stat.exists
      - verify_fonts_dir.stat.isdir
    fail_msg: "~/Library/Fonts directory does not exist"

- name: List Nerd Font files
  ansible.builtin.find:
    paths: "{{ ansible_facts['env']['HOME'] }}/Library/Fonts"
    patterns: "*Nerd Font*"
  register: verify_nerdfonts

- name: Assert at least one Nerd Font is installed
  ansible.builtin.assert:
    that:
      - verify_nerdfonts.files | length > 0
    fail_msg: "No Nerd Font files found in ~/Library/Fonts"
