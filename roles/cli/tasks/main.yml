---
- name: install various clis
  become: true
  become_user: "{{ ansible_facts.env.USER }}"
  homebrew:
    name: "{{ clitools_brew_packages }}"
    state: latest

- name: ensure virtual environment is created
  command: python3 -m venv "{{ ansible_facts.env.HOME }}/.clitools"
  args:
    creates: "{{ ansible_facts.env.HOME }}/.clitools/bin/activate"
  environment:
    PATH: "/opt/homebrew/bin:/usr/local/bin:{{ ansible_facts.env.PATH }}"

- name: install python tooling in virtual environment
  pip:
    name: "{{ clitools_python_packages }}"
    state: latest
    virtualenv: "{{ ansible_facts.env.HOME }}/.clitools"
  environment:
    PATH: "/opt/homebrew/bin:/usr/local/bin:{{ ansible_facts.env.PATH }}"
