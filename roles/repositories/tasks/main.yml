---
- name: Install git
  become_user: "{{ ansible_facts['env']['USER'] }}"
  community.general.homebrew:
    name:
      - git
    state: latest

- name: Create dev directory
  become: true
  ansible.builtin.file:
    path: "{{ ansible_facts['env']['HOME'] }}/dev/"
    state: directory
    mode: "0755"
    owner: "{{ ansible_facts['env']['USER'] }}"

- name: Create work directory
  become: true
  ansible.builtin.file:
    path: "{{ ansible_facts['env']['HOME'] }}/work/"
    state: directory
    mode: "0755"
    owner: "{{ ansible_facts['env']['USER'] }}"

- name: Download dotfiles repository
  become_user: "{{ ansible_facts['env']['USER'] }}"
  git:
    repo: "git@github.com:drew138/.dotfiles.git"
    dest: "{{ ansible_facts['env']['HOME'] }}/.dotfiles"
    clone: true
    update: true
  changed_when: false

- name: Download repositories
  become_user: "{{ ansible_facts['env']['USER'] }}"
  git:
    repo: "git@github.com:drew138/{{ item }}.git"
    dest: "{{ ansible_facts['env']['HOME'] }}/dev/{{ item }}"
    clone: true
    update: true
  with_items: "{{ repository_names }}"
