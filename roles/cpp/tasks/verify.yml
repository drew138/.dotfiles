---
- name: check directory stats
  ansible.builtin.stat:
    path: "{{ item }}"
  loop:
    - /usr/local/include
    - /usr/local/include/bits
  register: verify_cpp_dir_stats

- name: assert include directories exist
  ansible.builtin.assert:
    that:
      - item.stat.exists
      - item.stat.isdir
    fail_msg: "Directory missing: {{ item.item }}"
  loop: "{{ verify_cpp_dir_stats.results }}"

- name: check stdc++.h file stats
  ansible.builtin.stat:
    path: /usr/local/include/bits/stdc++.h
  register: verify_stdc_header_stat

- name: assert stdc++.h is present
  ansible.builtin.assert:
    that:
      - verify_stdc_header_stat.stat.exists
      - verify_stdc_header_stat.stat.isreg
    fail_msg: "The C++ header stdc++.h was not found in /usr/local/include/bits/"
